addEventListener("message",({data:m})=>{const a={};let n=null;const _=m.jsonData,x=m.member,t=m=>{const a=x.find(a=>a.id===m);return void 0===a?{ni:null,nj:null}:a},r=m=>{let a=null;try{const _=m.toString().trim();_.length>0&&(n=+_,a=isNaN(n)?null:n)}catch(_){a=null}var n;return a},i={},d={};try{for(const m of Object.keys(_)){const n={fx:0,fy:0,fz:0,mx:0,my:0,mz:0},x={x:{max_d:-65535,min_d:65535,max_d_m:"0",min_d_m:"0",max_r:-65535,min_r:65535,max_r_m:"0",min_r_m:"0"},y:{max_d:-65535,min_d:65535,max_d_m:"0",min_d_m:"0",max_r:-65535,min_r:65535,max_r_m:"0",min_r_m:"0"},z:{max_d:-65535,min_d:65535,max_d_m:"0",min_d_m:"0",max_r:-65535,min_r:65535,max_r_m:"0",min_r_m:"0"}},l=new Array,h=_[m];if("object"!=typeof h||!("fsec"in h))continue;const e=h.fsec;let o=0,s="";for(const m of Object.keys(e)){let a=0;s=m.replace("member","");const _=e[m];let i={};const d=t(s);let h=d.ni,y="",M=1;const u=Object.keys(_).length;for(;M<=u;){const n="P"+M.toString();if(!(n in _))break;const t=_[n];let e=r(t.fxi),z=r(t.fyi),c=r(t.fzi),f=r(t.mxi),b=r(t.myi),j=r(t.mzi);e=null==e?0:Math.round(100*e)/100,z=null==z?0:Math.round(100*z)/100,c=null==c?0:Math.round(100*c)/100,f=null==f?0:Math.round(100*f)/100,b=null==b?0:Math.round(100*b)/100,j=null==j?0:Math.round(100*j)/100,i={m:s,n:h,l:a,fx:e,fy:z,fz:c,mx:f,my:b,mz:j},o++,i.row=o;const g=void 0!==l[l.length-1]?l[l.length-1]:{l:"",m:"",n:"",row:""},w=i;w.row-=1,(w.l!==g.l||w.m!==g.m||w.n!==g.n||w.row!==g.row)&&l.push(i),s="",h="",M===u&&(y=d.nj);const p=r(t.L);let v=r(t.fxj),k=r(t.fyj),O=r(t.fzj),L=r(t.mxj),N=r(t.myj),S=r(t.mzj);a+=Math.round(1e3*p)/1e3,v=null==v?0:Math.round(100*v)/100,k=null==k?0:Math.round(100*k)/100,O=null==O?0:Math.round(100*O)/100,L=null==L?0:Math.round(100*L)/100,N=null==N?0:Math.round(100*N)/100,S=null==S?0:Math.round(100*S)/100,i={m:"",n:y,l:a,fx:v,fy:k,fz:O,mx:L,my:N,mz:S},o++,i.row=o,l.push(i),M++,x.x.max_d=Math.max(e,v,x.x.max_d),x.x.min_d=Math.min(e,v,x.x.min_d),(x.x.max_d===e||x.x.max_d===v)&&(x.x.max_d_m=m),(x.x.min_d===e||x.x.min_d===v)&&(x.x.min_d_m=m),x.y.max_d=Math.max(z,k,x.y.max_d),x.y.min_d=Math.min(z,k,x.y.min_d),(x.y.max_d===z||x.y.max_d===k)&&(x.y.max_d_m=m),(x.y.min_d===z||x.y.min_d===k)&&(x.y.min_d_m=m),x.z.max_d=Math.max(c,O,x.z.max_d),x.z.min_d=Math.min(c,O,x.z.min_d),(x.z.max_d===c||x.z.max_d===O)&&(x.z.max_d_m=m),(x.z.min_d===c||x.z.min_d===O)&&(x.z.min_d_m=m),x.x.max_r=Math.max(f,L,x.x.max_r),x.x.min_r=Math.min(f,L,x.x.min_r),(x.x.max_r===f||x.x.max_r===L)&&(x.x.max_r_m=m),(x.x.min_r===f||x.x.min_r===L)&&(x.x.min_r_m=m),x.y.max_r=Math.max(b,N,x.y.max_r),x.y.min_r=Math.min(b,N,x.y.min_r),(x.y.max_r===b||x.y.max_r===N)&&(x.y.max_r_m=m),(x.y.min_r===b||x.y.min_r===N)&&(x.y.min_r_m=m),x.z.max_r=Math.max(j,S,x.z.max_r),x.z.min_r=Math.min(j,S,x.z.min_r),(x.z.max_r===j||x.z.max_r===S)&&(x.z.max_r_m=m),(x.z.min_r===j||x.z.min_r===S)&&(x.z.min_r_m=m)}n.fx=Math.max(Math.abs(x.x.max_d),Math.abs(x.x.min_d)),n.fy=Math.max(Math.abs(x.y.max_d),Math.abs(x.y.min_d)),n.fz=Math.max(Math.abs(x.z.max_d),Math.abs(x.z.min_d)),n.mx=Math.max(Math.abs(x.x.max_r),Math.abs(x.x.min_r)),n.my=Math.max(Math.abs(x.y.max_r),Math.abs(x.y.min_r)),n.mz=Math.max(Math.abs(x.z.max_r),Math.abs(x.z.min_r))}const y=m.replace("Case","");a[y]=l,i[y]=n,d[y]=x}}catch(l){n=l}postMessage({fsec:a,max_values:i,value_ranges:d,error:n})});