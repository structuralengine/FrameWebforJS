addEventListener("message",({data:m})=>{const a={};let n=null;const _=m.jsonData,t=m.member,x=m=>{const a=t.find(a=>a.id===m);return void 0===a?{ni:null,nj:null}:a},r=m=>{let a=null;try{const _=m.toString().trim();_.length>0&&(n=+_,a=isNaN(n)?null:n)}catch(_){a=null}var n;return a},i={},d={};try{for(const m of Object.keys(_)){const n={fx:0,fy:0,fz:0,mx:0,my:0,mz:0},t={x:{max_d:-65535,min_d:65535,max_d_m:"0",min_d_m:"0",max_r:-65535,min_r:65535,max_r_m:"0",min_r_m:"0"},y:{max_d:-65535,min_d:65535,max_d_m:"0",min_d_m:"0",max_r:-65535,min_r:65535,max_r_m:"0",min_r_m:"0"},z:{max_d:-65535,min_d:65535,max_d_m:"0",min_d_m:"0",max_r:-65535,min_r:65535,max_r_m:"0",min_r_m:"0"}},l=new Array,h=_[m];if("object"!=typeof h||!("fsec"in h))continue;const e=h.fsec;let o=0,s="";for(const m of Object.keys(e)){let a=0;s=m.replace("member","");const _=e[m];let i={};const d=x(s);let h=d.ni,M="",y=1;const u=Object.keys(_).length;for(;y<=u;){const x="P"+y.toString();if(!(x in _))break;const e=_[x];let z=r(e.fxi),f=r(e.fyi),c=r(e.fzi),b=r(e.mxi),j=r(e.myi),g=r(e.mzi);z=null==z?0:Math.round(100*z)/100,f=null==f?0:Math.round(100*f)/100,c=null==c?0:Math.round(100*c)/100,b=null==b?0:Math.round(100*b)/100,j=null==j?0:Math.round(100*j)/100,g=null==g?0:Math.round(100*g)/100,i={m:s,n:h,l:a,fx:z,fy:f,fz:c,mx:b,my:j,mz:g},o++,i.row=o;const w=void 0!==l[l.length-1]?l[l.length-1]:{l:"",m:"",n:"",row:""},p=i;p.row-=1,(p.l!==w.l||p.m!==w.m||p.n!==w.n||p.row!==w.row)&&l.push(i),s="",h="",y===u&&(M=d.nj);const v=r(e.L);let k=r(e.fxj),O=r(e.fyj),L=r(e.fzj),N=r(e.mxj),S=r(e.myj),A=r(e.mzj);a+=Math.round(1e3*v)/1e3,k=null==k?0:Math.round(100*k)/100,O=null==O?0:Math.round(100*O)/100,L=null==L?0:Math.round(100*L)/100,N=null==N?0:Math.round(100*N)/100,S=null==S?0:Math.round(100*S)/100,A=null==A?0:Math.round(100*A)/100,i={m:"",n:M,l:a,fx:k,fy:O,fz:L,mx:N,my:S,mz:A},o++,i.row=o,l.push(i),y++,n.fx=Math.max(Math.abs(z),Math.abs(k),n.fx),n.fy=Math.max(Math.abs(f),Math.abs(O),n.fy),n.fz=Math.max(Math.abs(c),Math.abs(L),n.fz),n.mx=Math.max(Math.abs(b),Math.abs(N),n.mx),n.my=Math.max(Math.abs(j),Math.abs(S),n.my),n.mz=Math.max(Math.abs(g),Math.abs(A),n.mz),t.x.max_d=Math.max(z,k,t.x.max_d),t.x.min_d=Math.min(z,k,t.x.min_d),(t.x.max_d===z||t.x.max_d===k)&&(t.x.max_d_m=m),(t.x.min_d===z||t.x.min_d===k)&&(t.x.min_d_m=m),t.y.max_d=Math.max(f,O,t.y.max_d),t.y.min_d=Math.min(f,O,t.y.min_d),(t.y.max_d===f||t.y.max_d===O)&&(t.y.max_d_m=m),(t.y.min_d===f||t.y.min_d===O)&&(t.y.min_d_m=m),t.z.max_d=Math.max(c,L,t.z.max_d),t.z.min_d=Math.min(c,L,t.z.min_d),(t.z.max_d===c||t.z.max_d===L)&&(t.z.max_d_m=m),(t.z.min_d===c||t.z.min_d===L)&&(t.z.min_d_m=m),t.x.max_r=Math.max(b,N,t.x.max_r),t.x.min_r=Math.min(b,N,t.x.min_r),(t.x.max_r===b||t.x.max_r===N)&&(t.x.max_r_m=m),(t.x.min_r===b||t.x.min_r===N)&&(t.x.min_r_m=m),t.y.max_r=Math.max(j,S,t.y.max_r),t.y.min_r=Math.min(j,S,t.y.min_r),(t.y.max_r===j||t.y.max_r===S)&&(t.y.max_r_m=m),(t.y.min_r===j||t.y.min_r===S)&&(t.y.min_r_m=m),t.z.max_r=Math.max(g,A,t.z.max_r),t.z.min_r=Math.min(g,A,t.z.min_r),(t.z.max_r===g||t.z.max_r===A)&&(t.z.max_r_m=m),(t.z.min_r===g||t.z.min_r===A)&&(t.z.min_r_m=m)}}const M=m.replace("Case","");a[M]=l,i[M]=n,d[M]=t}}catch(l){n=l}postMessage({fsec:a,max_values:i,value_ranges:d,error:n})});